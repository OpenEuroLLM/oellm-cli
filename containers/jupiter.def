Bootstrap: docker
From: nvcr.io/nvidia/pytorch:25.06-py3

%labels
    Author      oellm-cli
    Description Apptainer image for Jupiter JSC cluster (ARM64 / GH200) - lm-eval only

%post
    # Install uv into a global bin
    curl -LsSf https://astral.sh/uv/install.sh | env UV_INSTALL_DIR=/usr/local/bin sh
    export UV_TOOL_BIN_DIR=/usr/local/bin
    uv --version

    # Install lm-eval and its dependencies
    uv pip install --system --break-system-packages lm-eval \
        "transformers<=4.53.0" "datasets<4.0.0" wandb sentencepiece tiktoken accelerate

%environment
    export PATH=/usr/local/bin:$PATH

%runscript
    exec bash "$@"
